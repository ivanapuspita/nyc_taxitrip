version: 2

sources:
  - name: db_taxi 
    tables:
      - name: raw_taxi_trip
        columns:
          - name: VendorID
            tests:
              - accepted_values:
                  values: [1, 2]
                  quote: false
          - name: PULocationID
            tests:
              - not_null
          - name: DOLocationID
            tests:
              - not_null
          - name: RatecodeID
            tests:
              - accepted_values:
                  values: [1, 2, 3, 4, 5, 6]
                  quote: false
          - name: payment_type
            tests:
              - accepted_values:
                  values: [1, 2, 3, 4, 5, 6]
                  quote: false
          - name: trip_distance
            tests:
              - not_null
          - name: fare_amount
            tests:
              - not_null
          - name: extra
            tests:
              - not_null
          - name: mta_tax
            tests:
              - not_null
          - name: tolls_amount
            tests:
              - not_null
          - name: total_amount
            tests:
              - not_null
          - name: tip_amount
            tests:
              - not_null
          - name: improvement_surcharge
            tests:
              - not_null
          
              
      - name: monthly_passengers
      - name: monthly_trip_distance
      - name: monthly_transactions

models:
  - name: monthly_passengers
    description: model for monthly passengers
    columns:
      - name: year
        description: The year when the meter was engaged
      - name: month
        description: The month when the meter was engaged
      - name: total_amount_idr
        description: total amount in IDR
      - name: total_passenger
        description: The number of total passengers in the vehicle

models:
  - name: monthly_transactions
    description: model for monthly transactions
    columns:
      - name: year
        description: The year when the meter was engaged
      - name: month
        description: The month when the meter was engaged
      - name: payment_type_description
        description: the description of numeric code signifying how the passenger paid for the trip
      - name: payment_type
        description: A numeric code signifying how the passenger paid for the trip
      - name: total_monthly_transactions
        description: The number of total monthly transactions

models:
  - name: monthly_trip_distance
    description: model for monthly trip distance
    columns:
      - name: year
        description: The year when the meter was engaged
      - name: month
        description: The month when the meter was engaged
      - name: rate_code_description
        description: the description of the final rate code in effect at the end of the trip.
      - name: RateCodeID
        description: The final rate code in effect at the end of the trip
      - name: total_trip_distance
        description: The number of total trip distance

models:
  - name: taxi
    description: model for taxi
    columns:
      - name: VendorID
        description: A code indicating the TPEP provider that provided the record
      - name: lpep_pickup_datetime
        description:  The date and time when the meter was engaged
      - name: lpep_dropoff_datetime 
        description: The date and time when the meter was disengaged
      - name: Trip_distance 
        description: The elapsed trip distance in miles reported by the taximeter
      - name: PULocationID 
        description: TLC Taxi Zone in which the taximeter was engaged 
      - name: DOLocationID 
        description: TLC Taxi Zone in which the taximeter was disengaged 
      - name: RateCodeID
        description: The final rate code in effect at the end of the trip
      - name: Store_and_fwd_flag
        description: This flag indicates whether the trip record was held in vehicle memory before sending to the vendor, 
        aka “store and forward,” because the vehicle did not have a connection to the server
      - name: total_trip_distance
        description: The number of total trip distance
      - name: payment_type
        description: A numeric code signifying how the passenger paid for the trip
      - name: fare_amount 
        description: The time-and-distance fare calculated by the meter
      - name: Extra 
        description: Miscellaneous extras and surcharges.  Currently, this only includes the $0.50 and $1 rush hour and overnight charges
      - name: MTA_tax  
        description: $0.50 MTA tax that is automatically triggered based on the metered rate in use
      - name: Improvement_surcharge  
        description: $0.30 improvement surcharge assessed trips at the flag drop. The improvement surcharge began being levied in 2015
      - name: Tip_amount  
        description: Tip amount – This field is automatically populated for credit card tips. Cash tips are not included
      - name: Tolls_amount 
        description: Total amount of all tolls paid in trip
      - name: Total_amount 
        description: The total amount charged to passengers. Does not include cash tips
      - name: Congestion_Surcharge 
        description: Total amount collected in trip for NYS congestion surcharge
      - name: Airport_fee  
        description: $1.25 for pick up only at LaGuardia and John F. Kennedy Airports
